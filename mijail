#!/usr/bin/env bash
# Made by Sinfallas <sinfallas@yahoo.com>
# Licence: GPL-2
LC_ALL=C
if [[ "$EUID" != "0" ]]; then
	echo -e "\e[00;31mERROR: Debes ser root.\e[00m"
	exit 1
fi

echo -e "\e[00;1;92mReconstruyendo perfiles de Firejail.\e[00m"
playo="/etc/firejail/playonlinux.profile"
qbit="/etc/firejail/qbittorrent.profile"
vlcp="/etc/firejail/vlc.profile"
dropp="/etc/firejail/dropbox.profile"
#playonlinux
echo "include playonlinux.local" > "$playo"
echo "noblacklist "'${HOME}'"/.Steam" >> "$playo"
echo "noblacklist "'${HOME}'"/.local/share/Steam" >> "$playo"
echo "noblacklist "'${HOME}'"/.local/share/steam" >> "$playo"
echo "noblacklist "'${HOME}'"/.steam" >> "$playo"
echo "noblacklist "'${HOME}'"/.PlayOnLinux" >> "$playo"
echo "noblacklist "'${PATH}'"/nc" >> "$playo"
echo "include allow-python2.inc" >> "$playo"
echo "include allow-python3.inc" >> "$playo"
echo "include allow-perl.inc" >> "$playo"
echo "include disable-common.inc" >> "$playo"
echo "include disable-devel.inc" >> "$playo"
echo "include disable-interpreters.inc" >> "$playo"
echo "include disable-programs.inc" >> "$playo"
echo "caps.drop all" >> "$playo"
echo "netfilter" >> "$playo"
echo "nodvd" >> "$playo"
echo "nogroups" >> "$playo"
echo "nonewprivs" >> "$playo"
echo "noroot" >> "$playo"
echo "notv" >> "$playo"
echo "seccomp" >> "$playo"
echo "ignore apparmor" >> "$playo"
#qbitorrent
echo "include qbittorrent.local" > "$qbit"
echo "include globals.local" >> "$qbit"
echo "noblacklist "'${HOME}'"/.cache/qBittorrent" >> "$qbit"
echo "noblacklist "'${HOME}'"/.config/qBittorrent" >> "$qbit"
echo "noblacklist "'${HOME}'"/.config/qBittorrentrc" >> "$qbit"
echo "noblacklist "'${HOME}'"/.local/share/data/qBittorrent" >> "$qbit"
echo "noblacklist "'${HOME}'"/" >> "$qbit"
echo "include allow-python2.inc" >> "$qbit"
echo "include allow-python3.inc" >> "$qbit"
echo "include disable-common.inc" >> "$qbit"
echo "include disable-devel.inc" >> "$qbit"
echo "include disable-exec.inc" >> "$qbit"
echo "include disable-interpreters.inc" >> "$qbit"
echo "include disable-passwdmgr.inc" >> "$qbit"
echo "include disable-programs.inc" >> "$qbit"
echo "mkdir "'${HOME}'"/.cache/qBittorrent" >> "$qbit"
echo "mkdir "'${HOME}'"/.config/qBittorrent" >> "$qbit"
echo "mkfile "'${HOME}'"/.config/qBittorrentrc" >> "$qbit"
echo "mkdir "'${HOME}'"/.local/share/data/qBittorrent" >> "$qbit"
echo "whitelist "'${DOWNLOADS}'"" >> "$qbit"
echo "whitelist "'${HOME}'"/.cache/qBittorrent" >> "$qbit"
echo "whitelist "'${HOME}'"/.config/qBittorrent" >> "$qbit"
echo "whitelist "'${HOME}'"/.config/qBittorrentrc" >> "$qbit"
echo "whitelist "'${HOME}'"/.local/share/data/qBittorrent" >> "$qbit"
echo "include whitelist-common.inc" >> "$qbit"
echo "include whitelist-var-common.inc" >> "$qbit"
echo "apparmor" >> "$qbit"
echo "caps.drop all" >> "$qbit"
echo "machine-id" >> "$qbit"
echo "netfilter" >> "$qbit"
echo "nodbus" >> "$qbit"
echo "nodvd" >> "$qbit"
echo "nogroups" >> "$qbit"
echo "nonewprivs" >> "$qbit"
echo "noroot" >> "$qbit"
echo "nosound" >> "$qbit"
echo "notv" >> "$qbit"
echo "nou2f" >> "$qbit"
echo "novideo" >> "$qbit"
echo "protocol unix,inet,inet6,netlink" >> "$qbit"
echo "seccomp" >> "$qbit"
echo "shell none" >> "$qbit"
echo "private-bin python*,qbittorrent" >> "$qbit"
echo "private-dev" >> "$qbit"
echo "private-tmp" >> "$qbit"
#vlc
echo "include vlc.local" > "$vlcp"
echo "noblacklist "'${HOME}'"/.cache/vlc" >> "$vlcp"
echo "noblacklist "'${HOME}'"/.config/vlc" >> "$vlcp"
echo "noblacklist "'${HOME}'"/.local/share/vlc" >> "$vlcp"
echo "noblacklist "'${MUSIC}'"" >> "$vlcp"
echo "noblacklist "'${VIDEOS}'"" >> "$vlcp"
echo "include disable-common.inc" >> "$vlcp"
echo "include disable-devel.inc" >> "$vlcp"
echo "include disable-exec.inc" >> "$vlcp"
echo "include disable-interpreters.inc" >> "$vlcp"
echo "include disable-passwdmgr.inc" >> "$vlcp"
echo "include disable-programs.inc" >> "$vlcp"
echo "include disable-xdg.inc" >> "$vlcp"
echo "include whitelist-var-common.inc" >> "$vlcp"
echo "caps.drop all" >> "$vlcp"
echo "nogroups" >> "$vlcp"
echo "nonewprivs" >> "$vlcp"
echo "noroot" >> "$vlcp"
echo "nou2f" >> "$vlcp"
echo "protocol unix,inet,inet6,netlink" >> "$vlcp"
echo "seccomp" >> "$vlcp"
echo "shell none" >> "$vlcp"
echo "private-dev" >> "$vlcp"
echo "private-tmp" >> "$vlcp"
#dropbox
echo "#include dropbox.local" > "$dropp"
echo "noblacklist "'${HOME}'"/.config/autostart" >> "$dropp"
echo "noblacklist "'${HOME}'"/.dropbox" >> "$dropp"
echo "noblacklist "'${HOME}'"/.dropbox-dist" >> "$dropp"
echo "#include disable-common.inc" >> "$dropp"
echo "#include disable-devel.inc" >> "$dropp"
echo "#include disable-passwdmgr.inc" >> "$dropp"
echo "#include disable-programs.inc" >> "$dropp"
echo "mkdir "'${HOME}'"/.dropbox" >> "$dropp"
echo "mkdir "'${HOME}'"/.dropbox-dist" >> "$dropp"
echo "mkdir "'${HOME'"}/Dropbox" >> "$dropp"
echo "mkfile "'${HOME}'"/.config/autostart/dropbox.desktop" >> "$dropp"
echo "whitelist "'${HOME}'"/.config/autostart/dropbox.desktop" >> "$dropp"
echo "whitelist "'${HOME}'"/.dropbox" >> "$dropp"
echo "whitelist "'${HOME}'"/.dropbox-dist" >> "$dropp"
echo "whitelist "'${HOME}'"/Dropbox" >> "$dropp"
echo "include whitelist-common.inc" >> "$dropp"
echo "#caps.drop all" >> "$dropp"
echo "#netfilter" >> "$dropp"
echo "#no3d" >> "$dropp"
echo "#nodvd" >> "$dropp"
echo "#nogroups" >> "$dropp"
echo "#nonewprivs" >> "$dropp"
echo "noroot" >> "$dropp"
echo "nosound" >> "$dropp"
echo "notv" >> "$dropp"
echo "nou2f" >> "$dropp"
echo "novideo" >> "$dropp"
echo "protocol unix,inet,inet6" >> "$dropp"
echo "#seccomp" >> "$dropp"
echo "shell none" >> "$dropp"
echo "#private-dev" >> "$dropp"
echo "#private-tmp" >> "$dropp"
echo "noexec /tmp" >> "$dropp"
echo "ignore apparmor" >> "$dropp"
echo -e "\e[00;1;92mFinalizado.\e[00m"
